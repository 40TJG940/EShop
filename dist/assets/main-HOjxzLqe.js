import{r as W,a as G,g as K}from"./vendor-react-BtP0CW_r.js";import{r as l,L as b,u as F,a as B,N as P,b as $,c as H,H as Y,R as Q,d as S,e as X}from"./vendor-router-DX9q2sAQ.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const d of r)if(d.type==="childList")for(const m of d.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function n(r){const d={};return r.integrity&&(d.integrity=r.integrity),r.referrerPolicy&&(d.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?d.credentials="include":r.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function o(r){if(r.ep)return;r.ep=!0;const d=n(r);fetch(r.href,d)}})();var A={exports:{}},k={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I;function Z(){if(I)return k;I=1;var s=W(),i=Symbol.for("react.element"),n=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,r=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,d={key:!0,ref:!0,__self:!0,__source:!0};function m(j,h,p){var c,a={},u=null,x=null;p!==void 0&&(u=""+p),h.key!==void 0&&(u=""+h.key),h.ref!==void 0&&(x=h.ref);for(c in h)o.call(h,c)&&!d.hasOwnProperty(c)&&(a[c]=h[c]);if(j&&j.defaultProps)for(c in h=j.defaultProps,h)a[c]===void 0&&(a[c]=h[c]);return{$$typeof:i,type:j,key:u,ref:x,props:a,_owner:r.current}}return k.Fragment=n,k.jsx=m,k.jsxs=m,k}var O;function ee(){return O||(O=1,A.exports=Z()),A.exports}var e=ee(),T={},_;function se(){if(_)return T;_=1;var s=G();return T.createRoot=s.createRoot,T.hydrateRoot=s.hydrateRoot,T}var te=se();const re=K(te),D="eshop_auth_token",q="eshop_user_data",ae=()=>{const s=localStorage.getItem(D);if(!s)return null;try{const i=s.split(".");if(i.length!==3)return E(),null;const o=JSON.parse(atob(i[1])).exp*1e3;return Date.now()>=o?(console.log("Token expiré, suppression..."),E(),null):s}catch(i){return console.error("Erreur lors de la vérification du token:",i),E(),null}},ne=s=>{localStorage.setItem(D,s)},L=s=>{localStorage.setItem(q,JSON.stringify(s))},ie=()=>{const s=localStorage.getItem(q);return s?JSON.parse(s):null},E=()=>{localStorage.removeItem(D),localStorage.removeItem(q)},M=async s=>{try{const i=await fetch("https://dummyjson.com/auth/me",{method:"GET",headers:{Authorization:`Bearer ${s}`}});if(!i.ok)throw new Error("Failed to fetch user data");return await i.json()}catch(i){console.error("Error fetching user data:",i);try{const n=s.split(".");if(n.length===3){const o=JSON.parse(atob(n[1]));return{id:o.id,username:o.username,email:o.email,firstName:o.firstName,lastName:o.lastName,image:o.image||"https://www.gravatar.com/avatar/00000000000000000000000000000000?d=mp&f=y",gender:o.gender||"unknown"}}}catch(n){console.error("Error parsing JWT token:",n)}throw i}},oe={userAuthenticated:null,setUserAuthenticated:()=>{},isLoading:!0,logout:()=>{},checkAuth:()=>Promise.resolve()},C=l.createContext(oe),ce=({children:s})=>{const[i,n]=l.useState(null),[o,r]=l.useState(!0),d=async()=>{r(!0);try{console.log("Vérification de l'authentification...");const h=ie(),p=ae();if(!p)return console.log("Aucun token trouvé, déconnexion"),n(null),r(!1),!1;if(h)return console.log("Données utilisateur trouvées en cache"),n({...h,token:p}),m(p).catch(a=>{console.warn("Erreur lors du rafraîchissement des données:",a)}),r(!1),!0;console.log("Récupération des données utilisateur depuis l'API...");const c=await M(p);return c?(console.log("Données utilisateur récupérées avec succès"),n({token:p,...c}),L(c),r(!1),!0):(console.log("Échec de la récupération des données utilisateur"),E(),n(null),r(!1),!1)}catch(h){return console.error("Erreur lors de la vérification de l'authentification:",h),E(),n(null),r(!1),!1}},m=async h=>{try{const p=await M(h);p&&(n(c=>({...c,...p})),L(p))}catch(p){console.error("Erreur lors du rafraîchissement des données:",p)}};l.useEffect(()=>{d();const h=()=>{document.visibilityState==="visible"&&d()};return document.addEventListener("visibilitychange",h),()=>{document.removeEventListener("visibilitychange",h)}},[]);const j=()=>{n(null),E()};return e.jsx(C.Provider,{value:{userAuthenticated:i,setUserAuthenticated:n,isLoading:o,logout:j,checkAuth:d},children:s})},R=l.createContext({cart:[],addToCart:()=>{},removeFromCart:()=>{},updateQuantity:()=>{},clearCart:()=>{},getCartTotal:()=>0,getItemsCount:()=>0}),le=({children:s})=>{const[i,n]=l.useState([]),{userAuthenticated:o}=l.useContext(C),r=()=>o?`eshop_cart_${o.id}`:"eshop_cart_guest";l.useEffect(()=>{const a=r();console.log(`Chargement du panier pour la clé: ${a}`);const u=localStorage.getItem(a);if(u)try{n(JSON.parse(u))}catch(x){console.error(`Erreur lors du chargement du panier (${a}):`,x),localStorage.removeItem(a)}else n([])},[o]),l.useEffect(()=>{const a=r();localStorage.setItem(a,JSON.stringify(i))},[i,o]),l.useEffect(()=>{if(o){const a="eshop_cart_guest",u=localStorage.getItem(a);if(u)try{const x=JSON.parse(u);x.length>0&&(console.log("Fusion du panier invité avec le panier utilisateur"),n(N=>{const g=[...N];return x.forEach(f=>{const t=g.findIndex(v=>v.id===f.id);t!==-1?g[t]={...g[t],quantity:g[t].quantity+f.quantity}:g.push(f)}),g}),localStorage.removeItem(a))}catch(x){console.error("Erreur lors de la fusion des paniers:",x)}}},[o]);const d=(a,u=1)=>{n(x=>{const N=x.findIndex(g=>g.id===a.id);if(N!==-1){const g=[...x];return g[N]={...g[N],quantity:g[N].quantity+u},g}else return[...x,{...a,quantity:u}]})},m=a=>{n(u=>u.filter(x=>x.id!==a))},j=(a,u)=>{if(u<=0){m(a);return}n(x=>x.map(N=>N.id===a?{...N,quantity:u}:N))},h=()=>{n([])},p=()=>i.reduce((a,u)=>{const x=u.discountPercentage?u.price*(1-u.discountPercentage/100):u.price;return a+x*u.quantity},0),c=()=>i.reduce((a,u)=>a+u.quantity,0);return e.jsx(R.Provider,{value:{cart:i,addToCart:d,removeFromCart:m,updateQuantity:j,clearCart:h,getCartTotal:p,getItemsCount:c},children:s})},de=()=>{const{cart:s,getItemsCount:i,getCartTotal:n}=l.useContext(R),[o,r]=l.useState(!1),[d,m]=l.useState(!1),j=l.useRef(null),h=i(),p=n();return l.useEffect(()=>{if(h>0){m(!0);const c=setTimeout(()=>m(!1),500);return()=>clearTimeout(c)}},[h]),l.useEffect(()=>{const c=a=>{j.current&&!j.current.contains(a.target)&&r(!1)};return document.addEventListener("mousedown",c),()=>{document.removeEventListener("mousedown",c)}},[]),l.useEffect(()=>{if(o){const c=setTimeout(()=>{r(!1)},5e3);return()=>clearTimeout(c)}},[o]),e.jsxs("div",{className:"cart-icon-container",ref:j,children:[e.jsxs(b,{to:"/cart",className:`cart-icon ${d?"animate":""}`,onMouseEnter:()=>h>0&&r(!0),children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"9",cy:"21",r:"1"}),e.jsx("circle",{cx:"20",cy:"21",r:"1"}),e.jsx("path",{d:"M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]}),h>0&&e.jsx("span",{className:"cart-count",children:h})]}),o&&h>0&&e.jsxs("div",{className:"cart-preview",children:[e.jsxs("h4",{children:["Votre panier (",h," ",h>1?"articles":"article",")"]}),e.jsxs("div",{className:"cart-preview-items",children:[s.slice(0,3).map(c=>e.jsxs("div",{className:"cart-preview-item",children:[e.jsx("div",{className:"cart-preview-item-image",children:e.jsx("img",{src:c.thumbnail,alt:c.title})}),e.jsxs("div",{className:"cart-preview-item-details",children:[e.jsx("div",{className:"cart-preview-item-title",children:c.title}),e.jsxs("div",{className:"cart-preview-item-price",children:[c.quantity," x ",(c.discountPercentage?c.price*(1-c.discountPercentage/100):c.price).toFixed(2),"€"]})]})]},c.id)),s.length>3&&e.jsxs("div",{className:"cart-preview-more",children:["+",s.length-3," articles supplémentaires..."]})]}),e.jsxs("div",{className:"cart-preview-total",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:[p.toFixed(2),"€"]})]}),e.jsx(b,{to:"/cart",className:"cart-preview-button",children:"Voir le panier"})]})]})},ue=()=>{const{category:s}=F()||{category:null},i=B(),[n,o]=l.useState(!1),{userAuthenticated:r,logout:d,isLoading:m}=l.useContext(C),j=i.pathname.includes("/shop/"),h=s||"sunglasses";l.useEffect(()=>{const a=()=>{window.scrollY>50?o(!0):o(!1)};return window.addEventListener("scroll",a),()=>{window.removeEventListener("scroll",a)}},[]);const p={padding:n?"0.75rem 2rem":"1rem 2rem",boxShadow:n?"0 5px 15px rgba(0, 0, 0, 0.1)":"none",transition:"all 0.3s ease"},c=()=>{d()};return e.jsxs("header",{className:"header",style:p,children:[e.jsx("div",{className:"logo",children:e.jsx(b,{to:"/",style:{textDecoration:"none"},children:e.jsx("h1",{children:"Eshop"})})}),e.jsx("nav",{className:"main-nav",children:e.jsxs("ul",{children:[e.jsx("li",{children:e.jsx(P,{to:"/",end:!0,className:({isActive:a})=>a?"active":"",children:"Accueil"})}),e.jsx("li",{children:e.jsx(P,{to:"/shop/sunglasses",className:({isActive:a})=>a?"active":"",children:"Boutique"})}),e.jsx("li",{children:e.jsx(P,{to:"/cart",className:({isActive:a})=>a?"active":"",children:"Panier"})}),r&&e.jsx("li",{children:e.jsx(P,{to:"/dashboard",className:({isActive:a})=>a?"active":"",children:"Tableau de bord"})})]})}),e.jsxs("div",{className:"header-actions",children:[j&&e.jsxs("div",{className:"category-buttons",children:[e.jsx(b,{to:"/shop/sunglasses",className:`category-btn ${j&&h==="sunglasses"?"active":""}`,style:{textDecoration:"none"},children:"Lunettes de soleil"}),e.jsx(b,{to:"/shop/mens-shirts",className:`category-btn ${j&&h==="mens-shirts"?"active":""}`,style:{textDecoration:"none"},children:"Chemises pour hommes"})]}),e.jsxs("div",{className:"user-cart-actions",children:[e.jsx(de,{}),m?e.jsx("div",{className:"auth-loading",children:"⋯"}):r?e.jsx("div",{className:"auth-section",children:e.jsxs("div",{className:"user-info",children:[e.jsxs("span",{className:"user-greeting",children:["Bonjour, ",e.jsx(b,{to:"/dashboard",className:"user-name",children:r.firstName})]}),e.jsx("button",{onClick:c,className:"auth-button logout",children:"Se déconnecter"})]})}):e.jsx(b,{to:"/login",className:"auth-button login",children:"Se connecter"})]})]})]})},he=()=>e.jsx("footer",{className:"footer",children:e.jsxs("div",{className:"footer-content",children:[e.jsx("div",{className:"footer-logo",children:"Eshop"}),e.jsxs("nav",{className:"footer-links",children:[e.jsx("a",{href:"#legal",children:"Mentions légales"}),e.jsx("a",{href:"#contact",children:"Contact"})]})]})}),me=()=>{const s=[{id:"sunglasses",name:"Lunettes de soleil",image:"https://images.unsplash.com/photo-1577803645773-f96470509666?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",description:"Découvrez notre collection de lunettes de soleil tendance pour tous les styles."},{id:"mens-shirts",name:"Chemises pour hommes",image:"https://images.unsplash.com/photo-1596755094514-f87e34085b2c?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=500&q=80",description:"Explorez notre sélection de chemises pour hommes alliant confort et élégance."}];return e.jsxs("div",{className:"home-page",children:[e.jsx("div",{className:"hero-section",children:e.jsxs("div",{className:"hero-content",children:[e.jsx("h1",{children:"Bienvenue sur Eshop"}),e.jsx("p",{children:"Découvrez notre sélection de produits de qualité"}),e.jsx(b,{to:"/shop/sunglasses",className:"cta-button",children:"Commencer vos achats"})]})}),e.jsxs("div",{className:"categories-section",children:[e.jsx("h2",{children:"Nos catégories"}),e.jsx("div",{className:"categories-grid",children:s.map(i=>e.jsxs(b,{to:`/shop/${i.id}`,className:"category-card",children:[e.jsx("div",{className:"category-image",children:e.jsx("img",{src:i.image,alt:i.name})}),e.jsxs("div",{className:"category-info",children:[e.jsx("h3",{children:i.name}),e.jsx("p",{children:i.description})]})]},i.id))})]}),e.jsxs("div",{className:"features-section",children:[e.jsxs("div",{className:"feature",children:[e.jsx("div",{className:"feature-icon",children:"🚚"}),e.jsx("h3",{children:"Livraison rapide"}),e.jsx("p",{children:"Livraison sous 48h pour toutes vos commandes"})]}),e.jsxs("div",{className:"feature",children:[e.jsx("div",{className:"feature-icon",children:"💯"}),e.jsx("h3",{children:"Qualité garantie"}),e.jsx("p",{children:"Tous nos produits sont sélectionnés avec soin"})]}),e.jsxs("div",{className:"feature",children:[e.jsx("div",{className:"feature-icon",children:"🔄"}),e.jsx("h3",{children:"Retours faciles"}),e.jsx("p",{children:"30 jours pour changer d'avis"})]})]})]})},xe=({rating:s})=>{const i=Math.round(s*2)/2,n=[];for(let r=1;r<=5;r++)r<=Math.floor(i)?n.push("full"):r-.5===i?n.push("half"):n.push("empty");const o=r=>({animation:"scaleIn 0.3s forwards",animationDelay:`${r*.05}s`,opacity:0,transform:"translateY(5px)"});return e.jsx("div",{className:"ratings-container",children:n.map((r,d)=>e.jsxs("span",{className:`star ${r}`,style:o(d),children:[r==="full"&&"★",r==="half"&&"★",r==="empty"&&"☆"]},d))})},pe=({product:s})=>{const[i,n]=l.useState(!1),[o,r]=l.useState(!1),[d,m]=l.useState(!1),{addToCart:j}=l.useContext(R),{id:h,title:p,category:c,brand:a,rating:u,thumbnail:x,description:N,price:g,discountPercentage:f,stock:t}=s,v=(g-g*f/100).toFixed(2),y=f>0?`-${Math.round(f)}%`:null,w=()=>n(!0),V=()=>n(!1),z=t>10?"En stock ✓":t>0?`Derniers exemplaires! (${t})`:"Rupture de stock ✗",U={color:t>10?"#10b981":t>0?"#f59e0b":"#ef4444",fontWeight:t<=10?"bold":"normal",animation:t<=10&&t>0?"pulse 2s infinite":"none"},J=()=>{t<=0||(r(!0),setTimeout(()=>{j(s,1),r(!1),m(!0),setTimeout(()=>{m(!1)},2e3)},300))};return e.jsxs("article",{className:"product-card",onMouseEnter:w,onMouseLeave:V,children:[y&&e.jsx("div",{className:"discount-badge",children:y}),e.jsx("div",{className:"product-image",children:e.jsx("img",{src:x||"https://placehold.co/400x300?text=No+Image",alt:p})}),e.jsxs("div",{className:"product-info",children:[e.jsx("h3",{className:"product-title",children:p}),e.jsx("div",{className:"product-category",children:c}),e.jsx("p",{className:"product-description",style:{maxHeight:i?"100px":"60px",overflow:"hidden",transition:"max-height 0.3s ease"},children:N}),e.jsxs("div",{className:"product-rating",children:[e.jsx(xe,{rating:u}),e.jsxs("span",{className:"rating-value",children:["★",u.toFixed(1),"/5"]})]}),e.jsxs("div",{className:"product-pricing",children:[e.jsxs("div",{className:"discounted-price",children:[v,"€"]}),f>0&&e.jsxs("div",{className:"original-price",children:[g.toFixed(2),"€"]})]}),e.jsxs("div",{className:"product-footer",children:[e.jsx("button",{className:`buy-button ${o?"adding":""} ${d?"added":""} ${t<=0?"disabled":""}`,onClick:J,disabled:t<=0||o,children:d?"✓ Ajouté":o?"Ajout...":t<=0?"Indisponible":"Ajouter au panier"}),e.jsx("span",{className:"availability",style:U,children:z})]})]})]})},fe=({products:s})=>{const[i,n]=l.useState([]),[o,r]=l.useState(!1);return l.useEffect(()=>{if(s.length===0){n([]);return}const d=Math.min(6,s.length);if(n(s.slice(0,d)),s.length>d){r(!0);const m=setTimeout(()=>{n(s),r(!1)},300);return()=>clearTimeout(m)}},[s]),s.length===0?e.jsxs("div",{className:"no-products",children:["Aucun produit trouvé correspondant à vos critères",e.jsx("div",{className:"empty-animation",style:{fontSize:"3rem",marginTop:"1rem"},children:"🔍"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"products-grid",children:i.map((d,m)=>e.jsx(pe,{product:d},d.id))}),o&&e.jsx("div",{className:"loading-more",children:"Chargement de plus de produits..."})]})},je=({brands:s,selectedBrands:i,onBrandSelection:n,category:o})=>{const[r,d]=l.useState(!1),[m,j]=l.useState(null);l.useEffect(()=>{j(null)},[o]);const h=(u,x)=>{n(u,x),j(x?u:null),x&&setTimeout(()=>{j(null)},1e3)},p=()=>{d(!r)},c=i.length,a=s.length;return e.jsxs("div",{className:"brands-filter",children:[e.jsxs("div",{className:"brands-header",children:[e.jsx("h3",{className:"brands-title",children:"Marques disponibles"}),e.jsx("button",{className:"view-toggle",onClick:p,title:r?"Afficher moins":"Afficher tout",style:{background:"none",border:"none",color:"#3b82f6",fontSize:"0.9rem",cursor:"pointer",padding:"0",fontWeight:"500"},children:r?"Réduire":"Tout voir"})]}),e.jsxs("div",{className:"selected-count",style:{fontSize:"0.85rem",color:"#666",marginBottom:"0.75rem"},children:[c," sur ",a," sélectionnées"]}),e.jsx("div",{className:"brand-list",style:{maxHeight:r?"500px":"200px",overflow:"auto",transition:"max-height 0.3s ease"},children:s.map((u,x)=>{const g=i.includes(u),f=m===u;return e.jsxs("label",{className:"brand-checkbox",style:{transform:f?"scale(1.05)":"scale(1)",background:f?"rgba(59, 130, 246, 0.05)":"transparent",borderRadius:"4px",transition:"all 0.3s ease",animation:f?"pulse 1s ease":"none",animationDelay:`${x*.05}s`},children:[e.jsx("input",{type:"checkbox",checked:g,onChange:t=>h(u,t.target.checked)}),e.jsxs("span",{className:"brand-name",children:[u," ",e.jsxs("span",{style:{color:"#999"},children:["(",1,")"]})]})]},u)})}),!r&&s.length>5&&e.jsx("div",{className:"fade-bottom",style:{position:"absolute",bottom:"0",left:"0",right:"0",height:"50px",background:"linear-gradient(to bottom, transparent, white)",pointerEvents:"none"}})]})},ge=({onSortChange:s,currentSort:i})=>{const[n,o]=l.useState(!1),[r,d]=l.useState(!1),m=[{value:"default",label:"Défaut",icon:"🔄"},{value:"price-asc",label:"Prix croissant",icon:"💰↑"},{value:"price-desc",label:"Prix décroissant",icon:"💰↓"},{value:"rating-desc",label:"Meilleures notes",icon:"⭐"},{value:"alphabetical",label:"Ordre alphabétique",icon:"🔤"}],j=()=>{o(!n),n||d(!0)},h=a=>{s(a),o(!1)};l.useEffect(()=>{if(!n){const a=setTimeout(()=>{d(!1)},300);return()=>clearTimeout(a)}},[n]);const p=()=>m.find(a=>a.value===i)||m[0],c=a=>({animation:r?"scaleIn 0.2s forwards":"none",animationDelay:`${a*.05}s`,opacity:r?0:1});return e.jsxs("div",{className:"order-by-container",children:[e.jsx("h3",{className:"order-by-title",children:"Trier par"}),e.jsxs("div",{className:"order-by-dropdown",children:[e.jsxs("button",{className:"dropdown-trigger",onClick:j,"aria-expanded":n,children:[e.jsx("span",{className:"sort-icon",children:p().icon}),e.jsx("span",{children:p().label}),e.jsx("span",{className:"dropdown-arrow",style:{transform:n?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s ease"},children:"▼"})]}),n&&e.jsx("div",{className:"dropdown-content",children:m.map((a,u)=>e.jsxs("div",{className:`sort-option ${i===a.value?"active":""}`,onClick:()=>h(a.value),style:c(u),children:[e.jsx("span",{className:"sort-icon",children:a.icon}),a.label]},a.value))})]})]})},ve=()=>{const{category:s}=F(),[i,n]=l.useState([]),[o,r]=l.useState([]),[d,m]=l.useState([]),[j,h]=l.useState("default"),[p,c]=l.useState(!0),[a,u]=l.useState(null);l.useEffect(()=>{(async()=>{c(!0);try{const t=await fetch(`https://dummyjson.com/products/category/${s}`);if(!t.ok)throw new Error("Failed to fetch products");const v=await t.json();n(v.products);const y=[...new Set(v.products.map(w=>w.brand))];r(y),m(y),u(null)}catch(t){console.error("Error fetching products:",t),u("Unable to load products. Please try again later.");try{let v;if(s==="sunglasses"){const y=await fetch("/src/data/sunglasses.json");y.ok&&(v=await y.json())}else{const y=await fetch("/src/data/mens-shirts.json");y.ok&&(v=await y.json())}if(v&&v.products){n(v.products);const y=[...new Set(v.products.map(w=>w.brand))];r(y),m(y)}}catch(v){console.error("Error loading local data:",v)}}finally{c(!1)}})()},[s]);const x=(f,t)=>{m(t?[...d,f]:d.filter(v=>v!==f))};let g=[...i.filter(f=>d.includes(f.brand))];switch(j){case"price-asc":g.sort((f,t)=>f.price-t.price);break;case"price-desc":g.sort((f,t)=>t.price-f.price);break;case"rating-desc":g.sort((f,t)=>t.rating-f.rating);break;case"alphabetical":g.sort((f,t)=>f.title.localeCompare(t.title));break}return e.jsxs("div",{className:"main-container",children:[e.jsxs("div",{className:"sidebar",children:[e.jsx("h2",{className:"sidebar-title",children:"Filtres"}),e.jsx("div",{className:"filter-section",children:e.jsx(je,{brands:o,selectedBrands:d,onBrandSelection:x,category:s})}),e.jsx("div",{className:"filter-section",children:e.jsx(ge,{onSortChange:h,currentSort:j})})]}),e.jsx("div",{className:"main-content",children:p?e.jsx("div",{className:"loading",children:"Chargement des produits..."}):a?e.jsx("div",{className:"error-message",children:a}):e.jsx(fe,{products:g})})]})},Ne=()=>{const[s,i]=l.useState(""),[n,o]=l.useState(""),[r,d]=l.useState(!1),[m,j]=l.useState(""),{setUserAuthenticated:h,userAuthenticated:p}=l.useContext(C),c=$(),a=B(),x=new URLSearchParams(a.search).get("redirect")||"/dashboard";l.useEffect(()=>{p&&c(x)},[p,c,x]);const N=async g=>{g.preventDefault(),d(!0),j("");try{const f=await fetch("https://dummyjson.com/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:s,password:n,expiresInMins:60})}),t=await f.json();if(!f.ok)throw new Error(t.message||"Erreur de connexion");const v={id:t.id,username:t.username,email:t.email,firstName:t.firstName,lastName:t.lastName,gender:t.gender,image:t.image,phone:t.phone,address:t.address};ne(t.token),L(v),h({token:t.token,...v}),console.log("Connexion réussie, redirection vers:",x),c(x)}catch(f){console.error("Erreur de connexion:",f),j(f.message||"Erreur de connexion. Veuillez réessayer.")}finally{d(!1)}};return e.jsx("div",{className:"login-container",children:e.jsxs("div",{className:"login-card",children:[e.jsx("h2",{children:"Connexion"}),e.jsxs("form",{onSubmit:N,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"username",children:"Nom d'utilisateur"}),e.jsx("input",{type:"text",id:"username",value:s,onChange:g=>i(g.target.value),required:!0,placeholder:"Entrez votre nom d'utilisateur"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",children:"Mot de passe"}),e.jsx("input",{type:"password",id:"password",value:n,onChange:g=>o(g.target.value),required:!0,placeholder:"Entrez votre mot de passe"})]}),m&&e.jsx("div",{className:"login-error",children:m}),e.jsx("button",{type:"submit",className:"login-button",disabled:r,children:r?"Connexion en cours...":"Se connecter"}),e.jsxs("div",{className:"login-help",children:[e.jsx("p",{children:"Pour les tests, utilisez les identifiants:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Username: kminchelle"}),e.jsx("li",{children:"Password: 0lelplR"})]})]})]})]})})},ye=()=>{var n,o,r;const{userAuthenticated:s,isLoading:i}=l.useContext(C);return i?e.jsx("div",{className:"dashboard-container",children:e.jsx("div",{className:"loading",children:"Chargement de vos informations..."})}):s?e.jsxs("div",{className:"dashboard-container",children:[e.jsxs("div",{className:"dashboard-header",children:[e.jsx("h2",{children:"Tableau de bord"}),e.jsxs("p",{children:["Bienvenue, ",s.firstName," ",s.lastName,"!"]})]}),e.jsx("div",{className:"dashboard-content",children:e.jsxs("div",{className:"user-info-card",children:[e.jsx("div",{className:"user-avatar",children:e.jsx("img",{src:s.image,alt:"Avatar de l'utilisateur"})}),e.jsxs("div",{className:"user-details",children:[e.jsx("h3",{children:"Informations personnelles"}),e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Nom:"}),e.jsxs("span",{className:"info-value",children:[s.firstName," ",s.lastName]})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Email:"}),e.jsx("span",{className:"info-value",children:s.email})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Téléphone:"}),e.jsx("span",{className:"info-value",children:s.phone||"Non renseigné"})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Genre:"}),e.jsx("span",{className:"info-value",children:s.gender||"Non renseigné"})]}),e.jsxs("div",{className:"info-row",children:[e.jsx("span",{className:"info-label",children:"Adresse:"}),e.jsxs("span",{className:"info-value",children:[((n=s.address)==null?void 0:n.address)||"Non renseignée",",",((o=s.address)==null?void 0:o.city)||"",",",((r=s.address)==null?void 0:r.state)||""]})]})]})]})})]}):null},be=()=>{const{cart:s,removeFromCart:i,updateQuantity:n,clearCart:o,getCartTotal:r}=l.useContext(R),{userAuthenticated:d}=l.useContext(C),[m,j]=l.useState(!1),[h,p]=l.useState(""),c=$(),a=r(),u=a>50?0:5.99,x=a+u,N=(t,v)=>{n(t,parseInt(v,10))},g=t=>{i(t)},f=()=>{if(s.length!==0){if(!d){c("/login?redirect=cart");return}j(!0),setTimeout(()=>{j(!1),p("Votre commande a été passée avec succès !"),o(),setTimeout(()=>{c("/")},3e3)},2e3)}};return s.length===0&&!h?e.jsx("div",{className:"cart-page-container",children:e.jsxs("div",{className:"cart-empty",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"9",cy:"21",r:"1"}),e.jsx("circle",{cx:"20",cy:"21",r:"1"}),e.jsx("path",{d:"M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"})]}),e.jsx("h2",{children:"Votre panier est vide"}),e.jsx("p",{children:"Parcourez notre catalogue et ajoutez des produits à votre panier."}),e.jsx(b,{to:"/shop/sunglasses",className:"continue-shopping-btn",children:"Parcourir les produits"})]})}):h?e.jsx("div",{className:"cart-page-container",children:e.jsxs("div",{className:"order-success",children:[e.jsx("div",{className:"success-icon",children:"✓"}),e.jsx("h2",{children:h}),e.jsx("p",{children:"Vous allez être redirigé vers la page d'accueil..."})]})}):e.jsxs("div",{className:"cart-page-container",children:[e.jsx("h1",{className:"cart-title",children:"Votre panier"}),e.jsxs("div",{className:"cart-layout",children:[e.jsxs("div",{className:"cart-items",children:[e.jsxs("div",{className:"cart-header",children:[e.jsx("div",{className:"cart-header-product",children:"Produit"}),e.jsx("div",{className:"cart-header-price",children:"Prix"}),e.jsx("div",{className:"cart-header-quantity",children:"Quantité"}),e.jsx("div",{className:"cart-header-total",children:"Total"}),e.jsx("div",{className:"cart-header-actions"})]}),s.map(t=>{const v=t.discountPercentage?(t.price*(1-t.discountPercentage/100)).toFixed(2):t.price.toFixed(2),y=(v*t.quantity).toFixed(2);return e.jsxs("div",{className:"cart-item",children:[e.jsxs("div",{className:"cart-item-product",children:[e.jsx("div",{className:"cart-item-image",children:e.jsx("img",{src:t.thumbnail,alt:t.title})}),e.jsxs("div",{className:"cart-item-details",children:[e.jsx("div",{className:"cart-item-title",children:t.title}),e.jsx("div",{className:"cart-item-brand",children:t.brand})]})]}),e.jsxs("div",{className:"cart-item-price",children:[v,"€",t.discountPercentage>0&&e.jsxs("span",{className:"original-price",children:[t.price.toFixed(2),"€"]})]}),e.jsxs("div",{className:"cart-item-quantity",children:[e.jsx("button",{className:"quantity-btn",onClick:()=>N(t.id,t.quantity-1),disabled:t.quantity<=1,children:"-"}),e.jsx("input",{type:"number",min:"1",max:t.stock||99,value:t.quantity,onChange:w=>N(t.id,w.target.value)}),e.jsx("button",{className:"quantity-btn",onClick:()=>N(t.id,t.quantity+1),disabled:t.quantity>=(t.stock||99),children:"+"})]}),e.jsxs("div",{className:"cart-item-total",children:[y,"€"]}),e.jsx("div",{className:"cart-item-actions",children:e.jsx("button",{className:"remove-item-btn",onClick:()=>g(t.id),title:"Supprimer cet article",children:"×"})})]},t.id)}),e.jsxs("div",{className:"cart-actions",children:[e.jsx(b,{to:"/shop/sunglasses",className:"continue-shopping-btn",children:"Continuer les achats"}),e.jsx("button",{className:"clear-cart-btn",onClick:()=>o(),children:"Vider le panier"})]})]}),e.jsxs("div",{className:"cart-summary",children:[e.jsx("h2",{children:"Récapitulatif"}),e.jsxs("div",{className:"summary-row",children:[e.jsx("span",{children:"Sous-total:"}),e.jsxs("span",{children:[a.toFixed(2),"€"]})]}),e.jsxs("div",{className:"summary-row",children:[e.jsx("span",{children:"Frais de livraison:"}),e.jsx("span",{children:u===0?e.jsx("span",{className:"free-shipping",children:"Gratuit"}):`${u.toFixed(2)}€`})]}),u>0&&e.jsxs("div",{className:"shipping-note",children:["Plus que ",(50-a).toFixed(2),"€ pour la livraison gratuite!"]}),e.jsxs("div",{className:"summary-total",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:[x.toFixed(2),"€"]})]}),e.jsx("button",{className:`checkout-btn ${m?"loading":""}`,onClick:f,disabled:m,children:m?"Traitement...":"Passer la commande"}),!d&&e.jsx("div",{className:"login-reminder",children:e.jsxs("p",{children:["Veuillez vous ",e.jsx(b,{to:"/login?redirect=cart",children:"connecter"})," pour finaliser votre commande."]})}),e.jsxs("div",{className:"payment-methods",children:[e.jsxs("div",{className:"payment-method-icons",children:[e.jsx("span",{children:"💳"}),e.jsx("span",{children:"🔒"}),e.jsx("span",{children:"🌐"})]}),e.jsx("p",{children:"Paiement 100% sécurisé"})]})]})]})]})},we=({children:s})=>{const{userAuthenticated:i,isLoading:n}=l.useContext(C);return n?e.jsx("div",{className:"protected-route-loading",children:e.jsx("div",{className:"loading",children:"Vérification de l'authentification..."})}):i?s:e.jsx(H,{to:"/login",replace:!0})};function Ce(){return e.jsx(ce,{children:e.jsx(le,{children:e.jsx(Y,{children:e.jsxs("div",{className:"app-wrapper",children:[e.jsx(ue,{}),e.jsxs(Q,{children:[e.jsx(S,{path:"/",element:e.jsx(me,{})}),e.jsx(S,{path:"/shop/:category",element:e.jsx(ve,{})}),e.jsx(S,{path:"/login",element:e.jsx(Ne,{})}),e.jsx(S,{path:"/cart",element:e.jsx(be,{})}),e.jsx(S,{path:"/dashboard",element:e.jsx(we,{children:e.jsx(ye,{})})}),e.jsx(S,{path:"*",element:e.jsx(H,{to:"/",replace:!0})})]}),e.jsx(he,{})]})})})})}re.createRoot(document.getElementById("root")).render(e.jsx(X.StrictMode,{children:e.jsx(Ce,{})}));
